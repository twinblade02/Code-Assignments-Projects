{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "import torch\n",
    "from torch import nn\n",
    "import boto3\n",
    "from botocore.exceptions import ClientError\n",
    "import pandas as pd\n",
    "from torch import optim\n",
    "from torchvision import transforms\n",
    "from torch.utils.data import DataLoader, Dataset\n",
    "from sklearn.model_selection import train_test_split\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import random\n",
    "import timeit\n",
    "from tqdm import tqdm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Core algorithm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Globals\n",
    "\n",
    "RANDOM_SEED = 42\n",
    "BATCH_SIZE = 512\n",
    "EPOCHS = 40\n",
    "\n",
    "LEARNING_RATE = 1e-4\n",
    "NUM_CLASSES = 10\n",
    "PATCH_SIZE = 4\n",
    "IMG_SIZE = 28\n",
    "IN_CHANNELS = 1\n",
    "NUM_HEADS = 8\n",
    "DROPOUT = 0.001\n",
    "HIDDEN_DIM = 768\n",
    "ADAM_WEIGHT_DECAY = 0\n",
    "ADAM_BETAS = (0.9, 0.999)\n",
    "ACTIVATION = \"gelu\"\n",
    "NUM_ENCODERS = 4\n",
    "EMBED_DIM = (PATCH_SIZE ** 2) * IN_CHANNELS\n",
    "NUM_PATCHES = (IMG_SIZE // PATCH_SIZE) ** 2\n",
    "\n",
    "random.seed(RANDOM_SEED)\n",
    "np.random.seed(RANDOM_SEED)\n",
    "torch.manual_seed(RANDOM_SEED)\n",
    "torch.cuda.manual_seed(RANDOM_SEED)\n",
    "torch.cuda.manual_seed_all(RANDOM_SEED)\n",
    "torch.backends.cudnn.deterministic = True\n",
    "torch.backends.cudnn.benchmark = False\n",
    "\n",
    "device = \"cuda\" if torch.cuda.is_available() else \"cpu\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "torch.cuda.is_available()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "torch.Size([512, 50, 16])\n"
     ]
    }
   ],
   "source": [
    "class PatchEmbedding(nn.Module):\n",
    "    # This has only a single self-attention layer\n",
    "    def __init__(self, embed_dim, patch_size, num_patches, dropout, in_channels):\n",
    "        super().__init__()\n",
    "        self.patcher = nn.Sequential(\n",
    "            nn.Conv2d(\n",
    "                in_channels=in_channels,\n",
    "                out_channels=embed_dim,\n",
    "                kernel_size=patch_size,\n",
    "                stride=patch_size,\n",
    "            ),\n",
    "            nn.Flatten(2)\n",
    "        )\n",
    "\n",
    "        self.cls_token = nn.Parameter(torch.randn(size=(1, in_channels, embed_dim)), requires_grad=True)\n",
    "        self.position_embeddings = nn.Parameter(torch.randn(size=(1, num_patches+1, embed_dim)), requires_grad=True)\n",
    "        self.dropout = nn.Dropout(p=dropout)\n",
    "\n",
    "    def forward(self, x):\n",
    "        cls_token = self.cls_token.expand(x.shape[0], -1, -1)\n",
    "\n",
    "        x = self.patcher(x).permute(0,2,1)\n",
    "        x = torch.cat([cls_token, x], dim=1)\n",
    "        x = self.position_embeddings + x\n",
    "        x = self.dropout(x)\n",
    "        return x\n",
    "    \n",
    "model = PatchEmbedding(EMBED_DIM, PATCH_SIZE, NUM_PATCHES, DROPOUT, IN_CHANNELS).to(device)\n",
    "x = torch.randn(512, 1, 28, 28).to(device)\n",
    "\n",
    "print(model(x).shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "d:\\Anaconda\\envs\\DL-CV\\Lib\\site-packages\\torch\\nn\\modules\\transformer.py:385: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "torch.Size([512, 10])\n"
     ]
    }
   ],
   "source": [
    "class ViT(nn.Module):\n",
    "    # Additional layers can be added to this\n",
    "    def __init__(self, num_patches, img_size, num_classes, patch_size, embed_dim, num_encoders, num_heads, hidden_dim, dropout, activation, in_channels):\n",
    "        super().__init__()\n",
    "        self.embeddings_block = PatchEmbedding(embed_dim, patch_size, num_patches, dropout, in_channels)\n",
    "\n",
    "        encoder_layer = nn.TransformerEncoderLayer(d_model=embed_dim, nhead=num_heads, dropout=dropout, activation=activation, batch_first=True, norm_first=True)\n",
    "        self.encoder_blocks = nn.TransformerEncoder(encoder_layer, num_layers=num_encoders)\n",
    "\n",
    "        self.mlp_head = nn.Sequential(\n",
    "            nn.LayerNorm(normalized_shape=embed_dim),\n",
    "            nn.Linear(in_features=embed_dim, out_features=num_classes),\n",
    "        )\n",
    "\n",
    "    def forward(self, x):\n",
    "        x = self.embeddings_block(x)\n",
    "        x = self.encoder_blocks(x)\n",
    "        x = self.mlp_head(x[:, 0, :])\n",
    "        return x\n",
    "    \n",
    "model = ViT(NUM_PATCHES, IMG_SIZE, NUM_CLASSES, PATCH_SIZE, EMBED_DIM, NUM_ENCODERS, NUM_HEADS, HIDDEN_DIM, DROPOUT, ACTIVATION, IN_CHANNELS).to(device)\n",
    "x = torch.randn(512, 1, 28, 28).to(device)\n",
    "print(model(x).shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Read MNIST from S3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "s3_client = boto3.client('s3', aws_access_key_id='AKIAZXCHEMUAHN7ONNXB', aws_secret_access_key='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')\n",
    "obj = s3_client.get_object(Bucket=\"vit-bucket-dataset\", Key='train.csv')\n",
    "train_data = pd.read_csv(obj['Body'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "obj = s3_client.get_object(Bucket=\"vit-bucket-dataset\", Key=\"test.csv\")\n",
    "test_data = pd.read_csv(obj['Body'])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Training / Preprocessing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "train_df, val_df = train_test_split(train_data, test_size=0.2, random_state=RANDOM_SEED, shuffle=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "class TrainDataset(Dataset):\n",
    "    # Class defines key variables and preprocessing actions to images\n",
    "    def __init__(self, images, labels, indices):\n",
    "        self.images = images\n",
    "        self.labels = labels\n",
    "        self.indices = indices\n",
    "        self.transform = transforms.Compose([\n",
    "            transforms.ToPILImage(),\n",
    "            transforms.RandomRotation(15),\n",
    "            transforms.ToTensor(),\n",
    "            transforms.Normalize([0.5], [0.5])\n",
    "        ])\n",
    "\n",
    "    def __len__(self):\n",
    "        return len(self.images)\n",
    "    \n",
    "    def __getitem__(self, idx):\n",
    "        image = self.images[idx].reshape((28,28)).astype(np.uint8)\n",
    "        label = self.labels[idx]\n",
    "        index = self.indices[idx]\n",
    "        image = self.transform(image)\n",
    "\n",
    "        return {\"image\": image, \"label\": label, \"index\": index}\n",
    "    \n",
    "\n",
    "\n",
    "class ValidateDataset(Dataset):\n",
    "    def __init__(self, images, labels, indices):\n",
    "        self.images = images\n",
    "        self.labels = labels\n",
    "        self.indices = indices\n",
    "        self.transform = transforms.Compose([\n",
    "            transforms.ToTensor(),\n",
    "            transforms.Normalize([0.5], [0.5])\n",
    "        ])\n",
    "\n",
    "    def __len__(self):\n",
    "        return len(self.images)\n",
    "    \n",
    "    def __getitem__(self, idx):\n",
    "        image = self.images[idx].reshape((28,28)).astype(np.uint8)\n",
    "        label = self.labels[idx]\n",
    "        index = self.indices[idx]\n",
    "        image = self.transform(image)\n",
    "\n",
    "        return {\"image\": image, \"label\": label, \"index\": index}\n",
    "    \n",
    "\n",
    "class TestDataset(Dataset):\n",
    "    def __init__(self, images, indices):\n",
    "        self.images = images\n",
    "        self.indices = indices\n",
    "        self.transform = transforms.Compose([\n",
    "            transforms.ToTensor(),\n",
    "            transforms.Normalize([0.5], [0.5])\n",
    "        ])\n",
    "\n",
    "    def __len__(self):\n",
    "        return len(self.images)\n",
    "    \n",
    "    def __getitem__(self, idx):\n",
    "        image = self.images[idx].reshape((28,28)).astype(np.uint8)\n",
    "\n",
    "        index = self.indices[idx]\n",
    "        image = self.transform(image)\n",
    "\n",
    "        return {\"image\": image, \"index\": index}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "33600\n",
      "{'image': tensor([[[-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.5059,  0.9843, -0.0510, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.5059,  0.9922,  0.5843, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.5059,  1.0000,  0.1294, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000,  0.2784,  0.9686, -0.7961, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000,  0.3098,  0.2000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.9294,  0.8588, -0.1843, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.3020,  0.5059, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -0.9608,  0.6784, -0.0275, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.5216, -0.1373, -0.8980, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -0.4196,  0.9922, -0.8824, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000,  0.0275,  0.9529,  0.9922,  0.5137, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -0.9059,  0.5216,  0.8745, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000,  0.6471,  0.9922,  0.9922,  0.9922,  0.8353,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -0.7882,  0.9922, -0.7569, -1.0000, -1.0000,\n",
      "          -1.0000, -0.6941,  0.9922,  0.4588,  0.4588,  0.9922,  0.0275,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -0.1373,  0.9922, -0.9922, -1.0000, -0.9922,\n",
      "           0.0039,  0.9765, -0.4980, -0.8824,  0.0588,  0.9922,  0.0118,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000,  0.1529,  0.4353, -0.9922, -1.0000, -0.3333,\n",
      "           0.9922,  0.7255, -0.4980, -0.5216,  0.8980,  0.9216, -0.7804,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -0.4980,  0.9608,  0.4196, -1.0000, -0.6314,  0.7961,\n",
      "           0.7804, -0.7647, -1.0000,  0.6627,  0.9922,  0.1294, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -0.3412,  0.9922,  0.3176, -1.0000,  0.3098,  0.9843,\n",
      "           0.9843, -0.2314, -1.0000,  0.8039,  0.9373, -0.0353, -0.9373,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -0.3412,  0.9922, -0.3882, -0.4118,  0.9294,\n",
      "           0.1451, -1.0000, -0.8667,  0.9922, -0.2471, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -0.3961,  0.9843,  0.0039,  0.9216,  0.3255,\n",
      "          -0.8824, -0.2941,  0.8667, -0.3647, -0.9294, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000,  0.8431,  0.8118,  0.9922,  0.9294,\n",
      "           0.7255,  0.9922,  0.6078, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000,  0.1373,  0.9922,  0.9922,  0.9922,\n",
      "           0.8039,  0.3804, -0.8510, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.4902,  0.9922,  0.9451, -0.3569,\n",
      "          -0.3569, -0.7882, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -0.9608, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000]]]), 'label': np.int64(6), 'index': np.int64(34941)}\n",
      "------------------------------\n",
      "8400\n",
      "{'image': tensor([[[-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -0.9765,\n",
      "          -0.5137,  0.4510,  1.0000,  0.7961, -0.7804, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,  0.3569,\n",
      "           0.9843,  0.9843,  0.9843,  0.9843, -0.3647, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -0.9843, -0.0118,  0.9686,\n",
      "           0.3961, -0.5686, -0.6000,  0.9843,  0.2235, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -0.4667,  0.9843,  0.2078,\n",
      "          -1.0000, -1.0000, -0.8980,  0.7020,  0.2235, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.9294,  0.7961,  0.4745, -0.9529,\n",
      "          -1.0000, -1.0000, -0.8275,  0.9843,  0.2235, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.9137,  0.9843,  0.3098, -1.0000,\n",
      "          -1.0000, -1.0000, -0.8275,  0.9843,  0.2549, -0.9137, -0.9294,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.9294,  0.8431,  0.3098, -1.0000,\n",
      "          -1.0000, -1.0000, -0.8275,  0.9843,  0.9843,  0.9843,  0.4745,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000,  0.2314,  0.8275, -0.8745,\n",
      "          -1.0000, -1.0000, -0.5373,  0.9843,  0.9843,  0.9137, -0.3882,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -0.1765,  0.9843, -0.8353,\n",
      "          -1.0000, -0.9529,  0.4431,  0.9843,  0.9373, -0.4196, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -0.6157,  0.9843, -0.1059,\n",
      "          -1.0000, -0.0902,  0.9843,  0.9843, -0.3176, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -0.9137,  0.3176,  0.9608,\n",
      "           0.5686,  0.8980,  0.9294,  0.0667, -0.9216, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -0.3176,  0.9843,\n",
      "           0.9843,  0.9843,  0.7412, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -0.7412,  0.5451,  0.9843,\n",
      "           0.9843,  0.9843, -0.2235, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.6392,  0.3647,  0.9843,  0.9843,\n",
      "           0.9843,  0.4039, -0.9765, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -0.6549,  0.8588,  0.9843,  0.8275,  0.0039,\n",
      "           0.6078,  0.2627, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000,  0.2157,  0.9843,  0.7255, -0.8510, -1.0000,\n",
      "           0.2706,  0.4510, -0.9686, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000,  0.4824,  0.9843,  0.7569, -0.4667, -1.0000,\n",
      "          -0.4275,  0.9843, -0.5294, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000,  0.2941,  0.8510,  0.9843,  0.9765,  0.8980,\n",
      "           0.6549,  0.9843, -0.0275, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.7176,  0.1137,  0.6235,  0.9843,\n",
      "           0.9843,  0.9843, -0.0275, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -0.8980,  0.0667,\n",
      "           0.6784,  0.3176, -0.8039, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000]]]), 'label': np.int64(8), 'index': np.int64(5457)}\n",
      "------------------------------\n",
      "28000\n",
      "{'image': tensor([[[-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.9216, -0.8667, -0.8667, -0.8667,\n",
      "          -0.8667, -0.3647,  0.4118,  0.4118, -0.7255, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000,  0.0902,  0.9843,  0.9843,  0.9843,\n",
      "           0.9843,  0.9843,  0.9843,  0.9843, -0.6235, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -0.5294,  0.7882,  0.9843,  0.9843,  0.9843,\n",
      "           0.9843,  0.9843,  0.9843,  0.9843,  0.6235,  0.5451, -0.6392,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000,  0.6706,  0.9843,  0.9843,  0.9843,  0.9843,\n",
      "           0.9843,  0.9843,  0.9843,  0.9843,  0.9843,  0.9843,  0.7490,\n",
      "          -0.5922, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -0.4824,  0.8118,  0.9843,  0.9843,  0.9843,\n",
      "          -0.1529, -0.6863, -0.6863, -0.0980,  0.9137,  0.9843,  0.9843,\n",
      "           0.0510, -0.9765, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -0.5059, -0.1059, -0.1059, -0.1059,\n",
      "          -0.7098, -1.0000, -1.0000, -1.0000,  0.6078,  0.9843,  0.9843,\n",
      "           0.9843, -0.8824, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -0.5529,  0.9843,  0.9843,\n",
      "           0.9843, -0.8824, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -0.6706,  0.9843,  0.9843,\n",
      "           0.9843, -0.8824, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -0.2549,  0.9843,  0.9843,\n",
      "           0.9843, -0.8824, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000,  0.6078,  0.9843,  0.9843,\n",
      "           0.9843, -0.8824, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -0.5216, -0.2235,\n",
      "          -0.2471, -1.0000, -1.0000, -0.6471,  0.7569,  0.9843,  0.9843,\n",
      "           0.5294, -0.9216, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -0.9137,\n",
      "          -0.8039, -0.1765, -0.3490,  0.4824,  0.4824,  0.7882,  0.9843,\n",
      "           0.9686,  0.4824,  0.4824,  0.7098,  0.9843,  0.9843,  0.6471,\n",
      "          -0.7882, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -0.6706, -0.0902,  0.3569,\n",
      "           0.9843,  0.9843,  0.9843,  0.9843,  0.9843,  0.9843,  0.9843,\n",
      "           0.9843,  0.9843,  0.9843,  0.9843,  0.9843,  0.9843,  0.7333,\n",
      "          -0.0902, -0.9451, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -0.0745,  0.9843,  0.9843,\n",
      "           0.9843,  0.9843,  0.9216,  0.6627,  0.7412,  0.9843,  0.9843,\n",
      "           0.9843,  0.9843,  0.9843,  0.9843,  0.9843,  0.9843,  0.9843,\n",
      "           0.9843,  0.2549, -0.8824, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000,  0.9922,  0.9843,  0.9843,\n",
      "           0.9843,  0.4824, -0.2235, -1.0000, -0.7490,  0.5843,  0.9843,\n",
      "           0.9843,  0.9843,  0.8824, -0.0431, -0.0431,  0.4902,  0.9843,\n",
      "           0.9843,  0.9843,  0.3647, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000,  1.0000,  0.9843,  0.9843,\n",
      "           0.9843,  0.8667,  0.7412,  0.7412,  0.7412,  0.8902,  0.9843,\n",
      "           0.9843,  0.8039, -0.4510, -1.0000, -1.0000, -0.8667,  0.3725,\n",
      "           0.7961,  0.9843,  0.9843, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000,  0.2392,  0.9843,  0.9843,\n",
      "           0.9843,  0.9843,  0.9843,  0.9843,  0.9843,  0.9843,  0.6078,\n",
      "          -0.1686, -0.4902, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -0.5137,  0.9137,  0.2314, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -0.9529, -0.7961,  0.4039,\n",
      "           0.4039,  0.4039,  0.4039,  0.4039, -0.7647, -0.8824, -0.9216,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -0.8902, -0.9529, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000],\n",
      "         [-1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000,\n",
      "          -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000, -1.0000]]]), 'index': np.int64(0)}\n",
      "------------------------------\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 640x480 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 640x480 with 3 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure()\n",
    "f, axarr = plt.subplots(1,3)\n",
    "\n",
    "train_dataset = TrainDataset(train_df.iloc[:, 1:].values.astype(np.uint8), train_df.iloc[:, 0].values, train_df.index.values)\n",
    "print(len(train_dataset))\n",
    "print(train_dataset[0])\n",
    "axarr[0].imshow(train_dataset[0][\"image\"].squeeze(), cmap=\"gray\")\n",
    "axarr[0].set_title(\"Train Image\")\n",
    "print(\"-\"*30)\n",
    "\n",
    "val_dataset = ValidateDataset(val_df.iloc[:, 1:].values.astype(np.uint8), val_df.iloc[:, 0].values, val_df.index.values)\n",
    "print(len(val_dataset))\n",
    "print(val_dataset[0])\n",
    "axarr[1].imshow(val_dataset[0][\"image\"].squeeze(), cmap=\"gray\")\n",
    "axarr[1].set_title(\"Validation Image\")\n",
    "print(\"-\"*30)\n",
    "\n",
    "test_dataset = TestDataset(test_data.values.astype(np.uint8), test_data.index.values)\n",
    "print(len(test_dataset))\n",
    "print(test_dataset[0])\n",
    "axarr[2].imshow(test_dataset[0][\"image\"].squeeze(), cmap=\"gray\")\n",
    "axarr[2].set_title(\"Test Image\")\n",
    "print(\"-\"*30)\n",
    "\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "train_dataloader = DataLoader(dataset=train_dataset, batch_size=BATCH_SIZE, shuffle=True)\n",
    "val_dataloader = DataLoader(dataset=val_dataset, batch_size=BATCH_SIZE, shuffle=True)\n",
    "test_dataloader = DataLoader(dataset=test_dataset, batch_size=BATCH_SIZE, shuffle=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.03it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.95it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 1: 1.8855\n",
      "Valid Loss Epoch 1: 1.5833\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "  2%|         | 1/40 [00:14<09:31, 14.65s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 1: 0.3555\n",
      "Valid Accuracy EPOCH 1: 0.5121\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.06it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.12it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 2: 1.5428\n",
      "Valid Loss Epoch 2: 1.3751\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "  5%|         | 2/40 [00:29<09:16, 14.65s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 2: 0.5190\n",
      "Valid Accuracy EPOCH 2: 0.6089\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.01it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.12it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 3: 1.3606\n",
      "Valid Loss Epoch 3: 1.2061\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "  8%|         | 3/40 [00:44<09:04, 14.70s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 3: 0.6105\n",
      "Valid Accuracy EPOCH 3: 0.6987\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.83it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.14it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 4: 1.2338\n",
      "Valid Loss Epoch 4: 1.0874\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 10%|         | 4/40 [00:59<08:57, 14.93s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 4: 0.6728\n",
      "Valid Accuracy EPOCH 4: 0.7587\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.01it/s]\n",
      "100%|| 17/17 [00:01<00:00, 11.72it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 5: 1.1205\n",
      "Valid Loss Epoch 5: 0.9890\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 12%|        | 5/40 [01:14<08:42, 14.93s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 5: 0.7197\n",
      "Valid Accuracy EPOCH 5: 0.7915\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.01it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.50it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 6: 1.0453\n",
      "Valid Loss Epoch 6: 0.9770\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 15%|        | 6/40 [01:28<08:25, 14.86s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 6: 0.7482\n",
      "Valid Accuracy EPOCH 6: 0.7471\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.00it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.29it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 7: 0.9727\n",
      "Valid Loss Epoch 7: 0.8754\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 18%|        | 7/40 [01:43<08:09, 14.84s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 7: 0.7693\n",
      "Valid Accuracy EPOCH 7: 0.8086\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.04it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.31it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 8: 0.9026\n",
      "Valid Loss Epoch 8: 0.8707\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 20%|        | 8/40 [01:58<07:53, 14.79s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 8: 0.7883\n",
      "Valid Accuracy EPOCH 8: 0.7937\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.96it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.16it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 9: 0.8532\n",
      "Valid Loss Epoch 9: 0.7593\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 22%|       | 9/40 [02:13<07:39, 14.83s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 9: 0.8024\n",
      "Valid Accuracy EPOCH 9: 0.8389\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.01it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.57it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 10: 0.8037\n",
      "Valid Loss Epoch 10: 0.7050\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 25%|       | 10/40 [02:28<07:23, 14.80s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 10: 0.8135\n",
      "Valid Accuracy EPOCH 10: 0.8475\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.01it/s]\n",
      "100%|| 17/17 [00:01<00:00, 12.78it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 11: 0.7588\n",
      "Valid Loss Epoch 11: 0.6966\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 28%|       | 11/40 [02:42<07:09, 14.80s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 11: 0.8240\n",
      "Valid Accuracy EPOCH 11: 0.8511\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.93it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.28it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 12: 0.7136\n",
      "Valid Loss Epoch 12: 0.6297\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 30%|       | 12/40 [02:57<06:56, 14.86s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 12: 0.8352\n",
      "Valid Accuracy EPOCH 12: 0.8643\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.95it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.14it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 13: 0.6761\n",
      "Valid Loss Epoch 13: 0.5930\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 32%|      | 13/40 [03:12<06:41, 14.88s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 13: 0.8446\n",
      "Valid Accuracy EPOCH 13: 0.8754\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.90it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.34it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 14: 0.6430\n",
      "Valid Loss Epoch 14: 0.5789\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 35%|      | 14/40 [03:27<06:28, 14.93s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 14: 0.8487\n",
      "Valid Accuracy EPOCH 14: 0.8729\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.05it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.74it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 15: 0.6157\n",
      "Valid Loss Epoch 15: 0.5248\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 38%|      | 15/40 [03:42<06:10, 14.84s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 15: 0.8535\n",
      "Valid Accuracy EPOCH 15: 0.8864\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.94it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.18it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 16: 0.5867\n",
      "Valid Loss Epoch 16: 0.5161\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 40%|      | 16/40 [03:57<05:57, 14.88s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 16: 0.8609\n",
      "Valid Accuracy EPOCH 16: 0.8844\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.06it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.60it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 17: 0.5520\n",
      "Valid Loss Epoch 17: 0.4722\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 42%|     | 17/40 [04:12<05:40, 14.80s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 17: 0.8694\n",
      "Valid Accuracy EPOCH 17: 0.8988\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.97it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.36it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 18: 0.5347\n",
      "Valid Loss Epoch 18: 0.4744\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 45%|     | 18/40 [04:26<05:26, 14.82s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 18: 0.8707\n",
      "Valid Accuracy EPOCH 18: 0.8927\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.06it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.60it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 19: 0.5130\n",
      "Valid Loss Epoch 19: 0.4250\n",
      "Train Accuracy Epoch 19: 0.8743\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 48%|     | 19/40 [04:41<05:09, 14.75s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Valid Accuracy EPOCH 19: 0.9082\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.07it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.66it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 20: 0.4890\n",
      "Valid Loss Epoch 20: 0.4142\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 50%|     | 20/40 [04:56<04:53, 14.69s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 20: 0.8816\n",
      "Valid Accuracy EPOCH 20: 0.9070\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.98it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.36it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 21: 0.4763\n",
      "Valid Loss Epoch 21: 0.4159\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 52%|    | 21/40 [05:10<04:40, 14.74s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 21: 0.8814\n",
      "Valid Accuracy EPOCH 21: 0.8981\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.12it/s]\n",
      "100%|| 17/17 [00:01<00:00, 11.14it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 22: 0.4563\n",
      "Valid Loss Epoch 22: 0.3741\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 55%|    | 22/40 [05:25<04:25, 14.73s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 22: 0.8854\n",
      "Valid Accuracy EPOCH 22: 0.9161\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.97it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.61it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 23: 0.4387\n",
      "Valid Loss Epoch 23: 0.3667\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 57%|    | 23/40 [05:40<04:10, 14.76s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 23: 0.8895\n",
      "Valid Accuracy EPOCH 23: 0.9142\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  5.03it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.63it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 24: 0.4241\n",
      "Valid Loss Epoch 24: 0.3799\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 60%|    | 24/40 [05:55<03:55, 14.73s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 24: 0.8909\n",
      "Valid Accuracy EPOCH 24: 0.9046\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.98it/s]\n",
      "100%|| 17/17 [00:01<00:00, 14.01it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 25: 0.4131\n",
      "Valid Loss Epoch 25: 0.3523\n",
      "Train Accuracy Epoch 25: 0.8953\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 62%|   | 25/40 [06:09<03:41, 14.74s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Valid Accuracy EPOCH 25: 0.9161\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:13<00:00,  4.74it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.18it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 26: 0.3917\n",
      "Valid Loss Epoch 26: 0.3294\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 65%|   | 26/40 [06:25<03:29, 14.97s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 26: 0.8999\n",
      "Valid Accuracy EPOCH 26: 0.9185\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.18it/s]\n",
      "100%|| 17/17 [00:01<00:00, 12.70it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 27: 0.3864\n",
      "Valid Loss Epoch 27: 0.3101\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 68%|   | 27/40 [06:39<03:12, 14.80s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 27: 0.8998\n",
      "Valid Accuracy EPOCH 27: 0.9269\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.14it/s]\n",
      "100%|| 17/17 [00:01<00:00, 14.11it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 28: 0.3698\n",
      "Valid Loss Epoch 28: 0.3246\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 70%|   | 28/40 [06:54<02:55, 14.66s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 28: 0.9047\n",
      "Valid Accuracy EPOCH 28: 0.9211\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.15it/s]\n",
      "100%|| 17/17 [00:01<00:00, 14.04it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 29: 0.3662\n",
      "Valid Loss Epoch 29: 0.2998\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 72%|  | 29/40 [07:08<02:40, 14.56s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 29: 0.9036\n",
      "Valid Accuracy EPOCH 29: 0.9242\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.19it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.85it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 30: 0.3486\n",
      "Valid Loss Epoch 30: 0.3076\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 75%|  | 30/40 [07:22<02:24, 14.46s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 30: 0.9068\n",
      "Valid Accuracy EPOCH 30: 0.9192\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.14it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.86it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 31: 0.3376\n",
      "Valid Loss Epoch 31: 0.2982\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 78%|  | 31/40 [07:37<02:09, 14.43s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 31: 0.9107\n",
      "Valid Accuracy EPOCH 31: 0.9273\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.20it/s]\n",
      "100%|| 17/17 [00:01<00:00, 12.50it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 32: 0.3312\n",
      "Valid Loss Epoch 32: 0.2775\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 80%|  | 32/40 [07:51<01:55, 14.41s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 32: 0.9119\n",
      "Valid Accuracy EPOCH 32: 0.9331\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.11it/s]\n",
      "100%|| 17/17 [00:01<00:00, 14.18it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 33: 0.3185\n",
      "Valid Loss Epoch 33: 0.2816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 82%| | 33/40 [08:05<01:40, 14.41s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 33: 0.9158\n",
      "Valid Accuracy EPOCH 33: 0.9271\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.14it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.54it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 34: 0.3109\n",
      "Valid Loss Epoch 34: 0.2669\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 85%| | 34/40 [08:20<01:26, 14.40s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 34: 0.9164\n",
      "Valid Accuracy EPOCH 34: 0.9304\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.13it/s]\n",
      "100%|| 17/17 [00:01<00:00, 14.13it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 35: 0.2999\n",
      "Valid Loss Epoch 35: 0.2900\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 88%| | 35/40 [08:34<01:11, 14.39s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 35: 0.9208\n",
      "Valid Accuracy EPOCH 35: 0.9217\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.20it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.74it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 36: 0.2946\n",
      "Valid Loss Epoch 36: 0.2516\n",
      "Train Accuracy Epoch 36: 0.9209\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 90%| | 36/40 [08:48<00:57, 14.34s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Valid Accuracy EPOCH 36: 0.9354\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.08it/s]\n",
      "100%|| 17/17 [00:01<00:00, 12.46it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 37: 0.2991\n",
      "Valid Loss Epoch 37: 0.2434\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 92%|| 37/40 [09:03<00:43, 14.43s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 37: 0.9186\n",
      "Valid Accuracy EPOCH 37: 0.9360\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.17it/s]\n",
      "100%|| 17/17 [00:01<00:00, 14.04it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 38: 0.2876\n",
      "Valid Loss Epoch 38: 0.2330\n",
      "Train Accuracy Epoch 38: 0.9220\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 95%|| 38/40 [09:17<00:28, 14.39s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Valid Accuracy EPOCH 38: 0.9396\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.11it/s]\n",
      "100%|| 17/17 [00:01<00:00, 14.02it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 39: 0.2795\n",
      "Valid Loss Epoch 39: 0.2308\n",
      "Train Accuracy Epoch 39: 0.9228\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 98%|| 39/40 [09:32<00:14, 14.40s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Valid Accuracy EPOCH 39: 0.9399\n",
      "------------------------------\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 66/66 [00:12<00:00,  5.12it/s]\n",
      "100%|| 17/17 [00:01<00:00, 13.87it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Train loss Epoch 40: 0.2759\n",
      "Valid Loss Epoch 40: 0.2285\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 40/40 [09:46<00:00, 14.66s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy Epoch 40: 0.9248\n",
      "Valid Accuracy EPOCH 40: 0.9419\n",
      "------------------------------\n",
      "Training Time: 586.60s\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "criterion = nn.CrossEntropyLoss()\n",
    "optimizer = optim.Adam(model.parameters(), betas=ADAM_BETAS, lr=LEARNING_RATE, weight_decay=ADAM_WEIGHT_DECAY)\n",
    "\n",
    "start = timeit.default_timer()\n",
    "for epoch in tqdm(range(EPOCHS), position=0, leave=True):\n",
    "    model.train()\n",
    "    train_labels = []\n",
    "    train_preds = []\n",
    "    train_running_loss = 0\n",
    "    for idx, img_label in enumerate(tqdm(train_dataloader, position=0, leave=True)):\n",
    "        img = img_label[\"image\"].float().to(device)\n",
    "        label = img_label[\"label\"].type(torch.uint8).to(device)\n",
    "        y_pred = model(img)\n",
    "        y_pred_label = torch.argmax(y_pred, dim=1)\n",
    "\n",
    "        train_labels.extend(label.cpu().detach()) # move to CPU to avoid running out of memory\n",
    "        train_preds.extend(y_pred_label.cpu().detach())\n",
    "\n",
    "        loss = criterion(y_pred, label)\n",
    "\n",
    "        optimizer.zero_grad()\n",
    "        loss.backward()\n",
    "        optimizer.step()\n",
    "\n",
    "        train_running_loss += loss.item()\n",
    "\n",
    "    train_loss = train_running_loss / (idx + 1)\n",
    "\n",
    "    model.eval()\n",
    "    val_labels = []\n",
    "    val_preds = []\n",
    "    val_running_loss = 0\n",
    "    with torch.no_grad():\n",
    "        for idx, img_label in enumerate(tqdm(val_dataloader, position=0, leave=True)):\n",
    "            img = img_label[\"image\"].float().to(device)\n",
    "            label = img_label[\"label\"].type(torch.uint8).to(device)\n",
    "            y_pred = model(img)\n",
    "            y_pred_label = torch.argmax(y_pred, dim=1)\n",
    "\n",
    "            val_labels.extend(label.cpu().detach())\n",
    "            val_preds.extend(y_pred_label.cpu().detach())\n",
    "\n",
    "            loss = criterion(y_pred, label)\n",
    "            val_running_loss += loss.item()\n",
    "    val_loss = val_running_loss / (idx + 1)\n",
    "\n",
    "    print(\"-\"*30)\n",
    "    print(f'Train loss Epoch {epoch+1}: {train_loss:.4f}')\n",
    "    print(f'Valid Loss Epoch {epoch+1}: {val_loss:.4f}')\n",
    "    print(f'Train Accuracy Epoch {epoch+1}: {sum(1 for x,y in zip(train_preds, train_labels) if x == y) / len(train_labels):.4f}')\n",
    "    print(f\"Valid Accuracy EPOCH {epoch+1}: {sum(1 for x,y in zip(val_preds, val_labels) if x == y) / len(val_labels):.4f}\")\n",
    "    print(\"-\"*30)\n",
    "\n",
    "stop = timeit.default_timer()\n",
    "print(f\"Training Time: {stop-start:.2f}s\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "torch.cuda.empty_cache()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Testing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|| 55/55 [00:05<00:00, 10.11it/s]\n"
     ]
    }
   ],
   "source": [
    "labels = []\n",
    "ids = []\n",
    "imgs = []\n",
    "model.eval()\n",
    "\n",
    "with torch.no_grad():\n",
    "    for idx, sample in enumerate(tqdm(test_dataloader, position=0, leave=True)):\n",
    "        img = sample[\"image\"].to(device)\n",
    "        ids.extend([int(i)+1 for i in sample[\"index\"]])\n",
    "\n",
    "        outputs = model(img)\n",
    "\n",
    "        imgs.extend(img.detach().cpu())\n",
    "        labels.extend([int(i) for i in torch.argmax(outputs, dim=1)])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Visuals"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Figure size 640x480 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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z89X5tevX6/ze9KtbdiwwdB6S5cuVeZ/+MMfpKyh3pVTdddTADh27Jih7T/++GMpU/3ckvPs2LFDyqZOnSplp06dUm4fGBgoZc2aNZOyzZs3S9ns2bOlbN26dcr9qCb2FxUVKdf1ZjzzQURERFqx+SAiIiKt2HwQERGRVmw+iIiISCtOOL1JUFCQlIWEhCjXHTp0qJSdP39eyiZMmGB4/+3bt5eyiIgIKauqqpKy//7v/za8nzZt2hjKVI4cOSJlI0eOVK579epVw2Mi+8TExEjZ5cuXpez48ePK7Rvq5FIV1d0tAaBFixZSprpDpervgvRSTQRV3Y02OTlZub1q0ufOnTulTHU33LfeekvKLly4oNyP6q65DRHPfBAREZFWbD6IiIhIKzYfREREpBWbDyIiItKqwUw47dixo5QNGjRIyn7xi19ImWpiqaupJr0lJiZq2bdqUu6vfvUr5bpvvPGGlJWVlTl8TA2RatLxpk2bpOzNN9/UMRyP8eijj0pZz549leuOGzdOylSfu2qyI7nep59+aiizh2py/dixY6XswQcfVG6vqp+GiGc+iIiISCs2H0RERKQVmw8iIiLSis0HERERacXmg4iIiLRqMFe7DB48WMrmzZvn8P1cu3ZNyr777jspU10xAgBRUVEOH5OjtW3bVspeeukl5bqdO3eWsilTpkiZ1Wqt97hIfVVXv379lOvm5eU5ezhaqa5iUX0e//M//yNl9b0C4dlnn63X9uSe4uLipOydd96RshUrVkjZ1q1bnTImb8EzH0RERKQVmw8iIiLSis0HERERacXmg4iIiLQyCSGEqwdxo+LiYoSGhjr8fVUTyup76Nu3b5eyVatWSdmyZcukTDVpEwA++OADKUtISLB7bNVKSkqUeW0TRG+WlJQkZbVNYDTq448/lrJhw4bV6z1rY7VaERIS4pT3VnFW/apUVFRImarOv/rqK+X2qluH7969u/4DM+CVV16RsjZt2kiZPRNBVbdIv/POO6VM9WgCe/bz6quvStkf/vAHKSsuLjb8nireXLvuyM/PT8r2799vaFvVYzl++umneo/JUxmpXZ75ICIiIq3YfBAREZFWbD6IiIhIKzYfREREpFWDmXCqOsz63tVQdVfOy5cv1+s9mzdvLmVNmjQxtO25c+ekbPTo0cp1t2zZYug977jjDilbvny5lPXo0UO5vcViMbSfxo0bG1rPXt48ac/ohNPafP/991KmmqBsMpmkrL5fG9HR0VIWEBAgZfX9GVWxZ8Lp0qVLpez3v/+9lNV3cqmKN9euO0pLS5OyhQsXSln//v2l7NChQ04Zk6fihFMiIiJyO2w+iIiISCs2H0RERKSVXc3HvHnz0L17dwQHByMsLAxDhw7F8ePHa6wjhEBWVhYiIiIQEBCAxMREHDlyxKGDJrIXa5c8FWuXvJGPPSvn5eVh4sSJ6N69OyoqKjBz5kwkJyfj6NGjtkfEz58/HwsXLkR2djbat2+PF154AUlJSTh+/DiCg4OdchBGqB55rJpgZA/V5CxnTNg6ePCglL377rtSduzYMSnLzc2t174vXbokZQ8//LCU3X///crt//rXv0qZ6i6uzubJtVubLl26SNk//vEPw9ur7iiqUt87ghrljEnHJ06ckDLVz8mQIUMcvm9H8cbadaVOnTop88WLF0vZ2rVrpYyTSx3DruZj06ZNNf68YsUKhIWFYf/+/bj//vshhMCiRYswc+ZM2+2y33vvPYSHh2PVqlXK2zkT6cDaJU/F2iVvVK85H9WXmjZr1gwAUFBQgKKiIiQnJ9vWMZvN6NevH/Lz85XvUVZWhuLi4hoLkbM5onYB1i/px9olb1Dn5kMIgWnTpqFPnz7o3LkzAKCoqAgAEB4eXmPd8PBw22s3mzdvHkJDQ22L0VPBRHXlqNoFWL+kF2uXvEWdm49Jkybh0KFDWL16tfTazTclEkIob1QEADNmzIDVarUthYWFdR0SkSGOql2A9Ut6sXbJW9g156Pa5MmT8cknn2DHjh1o3bq1La++m2VRURFatWply8+fPy915dXMZjPMZnNdhmGX8ePHS9msWbOk7O2333b6WABg4sSJylx119Tr169L2dWrVx0+pvrYsWOHMlc90vzatWvOHk6tHFm7gL76VVHVimoyb8eOHZXb15Yb4YwJp6rT/jfPd7DXs88+K2WqO7t6Am+qXV2qJ+TeqLYJ76dPn5ayJ5980uFjMsrPz0/KVJO/Xfl9Wh92nfkQQmDSpElYv349tm3bJt0iOTo6GhaLBTk5ObasvLwceXl56N27t2NGTFQHrF3yVKxd8kZ2nfmYOHEiVq1ahY8//hjBwcG23yeGhoYiICAAJpMJGRkZmDt3LmJjYxEbG4u5c+ciMDAQo0aNcsoBEBnB2iVPxdolb2RX8/Hmm28CABITE2vkK1assD3AbPr06SgtLcWECRNw6dIl9OzZE1u2bOG15uRSrF3yVKxd8kZ2NR9GnmRpMpmQlZWFrKysuo6JyOFYu+SpWLvkjfhsFyIiItLKJIy01RoVFxc75Rbl1DBZrVaEhIRo25871m+/fv2UeW23xL9Zy5YtpUx19Vht1q1bJ2WqW5xfuHBByqp/5dAQsXbr709/+pOUDR06VLlu165dpUx1e35dFixYIGVJSUlS9tprrym3V/3c/fTTT/UfmAFGapdnPoiIiEgrNh9ERESkFZsPIiIi0orNBxEREWnFCafk1Thpr/5Un59q4lttdu/eLWWeeotznVi79unTp4+Ubd26VcrS09OV26uel+NKTZs2lbLMzEwpa9eunXL7iooKKRs5cmS9x2UEJ5wSERGR22HzQURERFqx+SAiIiKt2HwQERGRVpxwSl6Nk/bIU7F2a+fr6ytl27Ztk7KDBw9K2eTJk50xJLoBJ5wSERGR22HzQURERFqx+SAiIiKt2HwQERGRVj6uHgAREZE9WrZsKWUdO3aUsrFjx+oYDtUBz3wQERGRVmw+iIiISCs2H0RERKQVmw8iIiLSis0HERERacWrXYiIyKOcPXtWypo3b+6CkVBd8cwHERERacXmg4iIiLRi80FERERasfkgIiIirdh8EBERkVZsPoiIiEgrNh9ERESkFZsPIiIi0srtmg8hhKuHQF5Edz2xfslRWLvkqYzUkts1HyUlJa4eAnkR3fXE+iVHYe2SpzJSSybhZu1uVVUVzp49i+DgYJSUlKBNmzYoLCxESEiIq4dWb8XFxTweTYQQKCkpQUREBBo10tdjV9evEAKRkZFu+dnUhTv/XdeFOx8Pa9ex3Pnvui7c+XjsqV23e7ZLo0aN0Lp1awCAyWQCAISEhLjdh1wfPB49QkNDte+zun6Li4sBuO9nU1c8Hj1Yu47H49HDaO263a9diIiIyLux+SAiIiKt3Lr5MJvNmD17Nsxms6uH4hA8nobD2z4bHk/D4W2fDY/HPbndhFMiIiLybm595oOIiIi8D5sPIiIi0orNBxEREWnF5oOIiIi0cuvmY+nSpYiOjoa/vz8SEhKwc+dOVw/JkB07diA1NRUREREwmUzYsGFDjdeFEMjKykJERAQCAgKQmJiII0eOuGawtzFv3jx0794dwcHBCAsLw9ChQ3H8+PEa63jS8ejC2nU91m7dsHbdg7fXr9s2H2vXrkVGRgZmzpyJAwcOoG/fvkhJScHp06ddPbTbunLlCrp06YLFixcrX58/fz4WLlyIxYsXY+/evbBYLEhKSnLLZyvk5eVh4sSJ2L17N3JyclBRUYHk5GRcuXLFto4nHY8OrF33wNq1H2vXfXh9/Qo31aNHDzF+/PgaWVxcnMjMzHTRiOoGgPjzn/9s+3NVVZWwWCzixRdftGXXrl0ToaGh4q233nLBCO1z/vx5AUDk5eUJITz/eJyBteueWLu3x9p1X95Wv2555qO8vBz79+9HcnJyjTw5ORn5+fkuGpVjFBQUoKioqMaxmc1m9OvXzyOOzWq1AgCaNWsGwPOPx9FYu+6LtXtrrF335m3165bNx4ULF1BZWYnw8PAaeXh4OIqKilw0KseoHr8nHpsQAtOmTUOfPn3QuXNnAJ59PM7A2nVPrN3bY+26L2+sX7d7qu2Nqp9qW00IIWWeyhOPbdKkSTh06BA+//xz6TVPPB5n8ubPwxOPjbVrnDd/Hp56bN5Yv2555qNFixZo3Lix1L2dP39e6vI8jcViAQCPO7bJkyfjk08+QW5uLlq3bm3LPfV4nIW1635Yu8awdt2Tt9avWzYffn5+SEhIQE5OTo08JycHvXv3dtGoHCM6OhoWi6XGsZWXlyMvL88tj00IgUmTJmH9+vXYtm0boqOja7zuacfjbKxd98HatQ9r1714ff26YJKrIWvWrBG+vr5i2bJl4ujRoyIjI0MEBQWJkydPunpot1VSUiIOHDggDhw4IACIhQsXigMHDohTp04JIYR48cUXRWhoqFi/fr04fPiw+NWvfiVatWoliouLXTxy2ZNPPilCQ0PF9u3bxQ8//GBbrl69alvHk45HB9aue2Dt2o+16z68vX7dtvkQQoglS5aIqKgo4efnJ7p162a7xMjd5ebmCgDSkpaWJoT4+RKp2bNnC4vFIsxms7j//vvF4cOHXTvoWqiOA4BYsWKFbR1POh5dWLuux9qtG9aue/D2+jUJIYRzz60QERER/ZtbzvkgIiIi78Xmg4iIiLRi80FERERasfkgIiIirdh8EBERkVZsPoiIiEgrNh9ERESkFZsPIiIi0orNBxEREWnF5oOIiIi0YvNBREREWrH5ICIiIq3YfBAREZFWbD6IiIhIqwbffGRnZ8NkMtkWHx8ftG7dGunp6fj++++1jKFt27YYPXq07c/bt2+HyWTC9u3b7Xqf/Px8ZGVl4fLlyw4dHwCMHj0abdu2ve16N36WNy9xcXEOH1dDxto1xmjtvv766+jVqxdatGgBs9mMyMhIjBw5EkeOHHH4mBo61q4x3vy96+PqAbiLFStWIC4uDqWlpdixYwfmzZuHvLw8HD58GEFBQVrH0q1bN+zatQsdO3a0a7v8/HzMmTMHo0ePRtOmTZ0zuNvYtWuXlH3xxRfIyMjAww8/7IIReT/WrmP8+OOPSElJQZcuXXDHHXfgu+++w4svvoiePXti//796NChg0vG5c1Yu47hid+7bD7+pXPnzrj33nsBAP3790dlZSWef/55bNiwAb/+9a+V21y9ehWBgYEOH0tISAh69erl8PfVQTXut99+GyaTCU888YQLRuT9WLuOMWfOnBp/7tevH3r16oWOHTti5cqVeO6551w0Mu/F2nUMT/zebfC/dqlN9V/mqVOnAPx8+qtJkyY4fPgwkpOTERwcjAEDBgAAysvL8cILLyAuLg5msxktW7ZEeno6/vnPf9Z4z+vXr2P69OmwWCwIDAxEnz59sGfPHmnftZ3+++KLL5CamormzZvD398fMTExyMjIAABkZWXh2WefBQBER0fbTrnd+B5r167FL37xCwQFBaFJkyZ48MEHceDAAWn/2dnZ6NChA8xmM+Lj4/H+++/X6TMEgJKSEqxbtw79+vVDu3bt6vw+ZBxr1zG1CwAtW7YEAPj48P9pOrB2G873Ln+iavHtt98C+PeXD/BzsT/00EMYN24cMjMzUVFRgaqqKgwZMgQ7d+7E9OnT0bt3b5w6dQqzZ89GYmIi9u3bh4CAAADA2LFj8f777+OZZ55BUlISvvzySwwbNgwlJSW3Hc/mzZuRmpqK+Ph4LFy4EJGRkTh58iS2bNkCABgzZgwuXryIN954A+vXr0erVq0AwHYKce7cuZg1axbS09Mxa9YslJeXY8GCBejbty/27NljWy87Oxvp6ekYMmQIXnnlFVitVmRlZaGsrAyNGtnfq65ZswZXrlzBmDFj7N6W6oa1W7/araysREVFBQoKCpCZmYmwsDCkp6cb3p7qjrXbgL53RQO3YsUKAUDs3r1bXL9+XZSUlIiNGzeKli1biuDgYFFUVCSEECItLU0AEMuXL6+x/erVqwUA8dFHH9XI9+7dKwCIpUuXCiGE+OqrrwQAMXXq1BrrrVy5UgAQaWlptiw3N1cAELm5ubYsJiZGxMTEiNLS0lqPZcGCBQKAKCgoqJGfPn1a+Pj4iMmTJ9fIS0pKhMViESNGjBBCCFFZWSkiIiJEt27dRFVVlW29kydPCl9fXxEVFVXrvmvTs2dP0bRp01uOm+qGteuc2jWbzQKAACDat28vjh49anhbMoa1y+9d/trlX3r16gVfX18EBwdj8ODBsFgs+PTTTxEeHl5jveHDh9f488aNG9G0aVOkpqaioqLCtnTt2hUWi8V2+i03NxcApN9jjhgx4randL/++mucOHECTzzxBPz9/e0+ts2bN6OiogKPP/54jTH6+/ujX79+tjEeP34cZ8+exahRo2AymWzbR0VFoXfv3nbv98iRI/jiiy/w61//uk7jJmNYu46t3fz8fOzatQv/+7//i+DgYPTv359XvDgJa7fhfu/y1y7/8v777yM+Ph4+Pj4IDw+3nT67UWBgIEJCQmpk586dw+XLl+Hn56d83wsXLgD4eSY9AFgslhqv+/j4oHnz5rccW/XvMFu3bm3sYG5y7tw5AED37t2Vr1ef1qttjNXZyZMn7drvsmXLAMC9T/15AdauY2u3W7duAH7+h/Ghhx5Cu3bt8P/+3//Dxx9/bM/QyQDWbsP93mXz8S/x8fG2Wde1ubErrdaiRQs0b94cmzZtUm4THBwMALZCLyoqwp133ml7vaKiwlZ8tan+/eeZM2duuV5tWrRoAQD48MMPERUVVet6N47xZqrsVsrLy/GnP/0JCQkJ6Nq1q13bkn1Yu46t3RsFBwcjLi4OX3/9dZ3fg2rH2m2437tsPupp8ODBWLNmDSorK9GzZ89a10tMTAQArFy5EgkJCbb8gw8+QEVFxS330b59e8TExGD58uWYNm0azGazcr3qvLS0tEb+4IMPwsfHBydOnJBOX96oQ4cOaNWqFVavXo1p06bZfuhPnTqF/Px8RERE3HKcN/rkk09w4cIFXp7oxli7t3fhwgUcPnwY9913X522J+dg7ap50vcum496GjlyJFauXIlBgwZhypQp6NGjB3x9fXHmzBnk5uZiyJAhePjhhxEfH4/HHnsMixYtgq+vLx544AF8+eWXePnll6VTiipLlixBamoqevXqhalTpyIyMhKnT5/G5s2bsXLlSgDAXXfdBQB47bXXkJaWBl9fX3To0AFt27bFc889h5kzZ+K7777DwIEDcccdd+DcuXPYs2cPgoKCMGfOHDRq1AjPP/88xowZg4cffhhjx47F5cuXkZWVpTwleCvLli1DQEAARo0aZf+HSlqwdv/NarUiKSkJo0aNQmxsLAICAvD111/jtddeQ1lZGWbPnl2/D5scirWr5lHfu66e8epq1bOu9+7de8v10tLSRFBQkPK169evi5dffll06dJF+Pv7iyZNmoi4uDgxbtw48c0339jWKysrE08//bQICwsT/v7+olevXmLXrl0iKirqtrOuhRBi165dIiUlRYSGhgqz2SxiYmKkWdwzZswQERERolGjRtJ7bNiwQfTv31+EhIQIs9ksoqKixCOPPCK2bt1a4z3effddERsbK/z8/ET79u3F8uXLRVpamuFZ16dPnxaNGjUSjz/+uKH1qW5Yu46r3WvXrokxY8aI+Ph40aRJE+Hj4yNat24tHnvsMXHkyJFbbkv2Y+3ye9ckhBAu63yIiIioweGltkRERKQVmw8iIiLSis0HERERacXmg4iIiLRi80FERERaOe0+H0uXLsWCBQvwww8/oFOnTli0aBH69u172+2qqqpw9uxZBAcHK+9sR2SEEAIlJSWIiIiw+6mQda1dgPVL9cfaJU9lV+064/rdNWvWCF9fX/HOO++Io0ePiilTpoigoCBx6tSp225bWFhoe6IkFy71XQoLC7XVLuuXiyMX1i4XT12M1K5Tmo8ePXqI8ePH18ji4uJEZmbmbbe9fPmyyz84Lt6zXL58WVvtsn65OHJh7XLx1MVI7Tp8zkd5eTn279+P5OTkGnlycjLy8/Ol9cvKylBcXGxbSkpKHD0kasDsOX1sb+0CrF9yHtYueSojtevw5uPChQuorKxEeHh4jTw8PFz5hL558+YhNDTUtrRp08bRQyIyxN7aBVi/5B5Yu+RpnHa1y82djxBC2Q3NmDEDVqvVthQWFjprSESGGK1dgPVL7oW1S57C4Ve7tGjRAo0bN5a67fPnz0tdOfDz44hre1QxkU721i7A+iX3wNolT+PwMx9+fn5ISEhATk5OjTwnJwe9e/d29O6IHIa1S56KtUsex67p1AZVX/K1bNkycfToUZGRkSGCgoLEyZMnb7ut1Wp1+UxdLt6zWK1WbbXL+uXiyIW1y8VTFyO165TmQwghlixZIqKiooSfn5/o1q2byMvLM7QdfwC4OHKx9wu8PrXL+uXiyIW1y8VTFyO1axJCCLiR4uJihIaGunoY5CWsVitCQkK07Y/1S47C2iVPZaR2+WwXIiIi0orNBxEREWnF5oOIiIi0YvNBREREWrH5ICIiIq3YfBAREZFWDr+9OhF5v+DgYGU+YMAAKUtLSzO03jfffCNlixYtUu5n/fr1UnblyhXlukTkfnjmg4iIiLRi80FERERasfkgIiIirdh8EBERkVZ8tgt5NT4fo/4CAwOl7L333lOuO3z4cCmrz1eMyWRS5seOHZOygQMHStnp06frvG9XY+2Sp+KzXYiIiMjtsPkgIiIirdh8EBERkVZsPoiIiEgr3uGUiG7pmWeekbJhw4Yp171+/bqUvfLKK4b2k5qaKmWdOnVSrtuhQwcpe+utt6Rs0KBBhvZNRHrxzAcRERFpxeaDiIiItGLzQURERFqx+SAiIiKtOOGUiG5JdYfT2owePVrKVq9ebWjbrKwsKZs9e7Zy3czMTCkbMGCAlDVr1kzKLl68aGg8ROQ8PPNBREREWrH5ICIiIq3YfBAREZFWbD6IiIhIK5Ooz/OunaChP9Y5Li5OylSPD2/USO4bVRMD27Ztq9xP//79DY3n448/ljJPekw5H0vuHK1atVLmP/zwg0P306JFC2Wen58vZe3atZOyefPmSdnMmTPrPzANGlrtpqSkSNmbb76pXDcyMtLQey5fvtzw/j/77DMpU33XHT58WMqKi4sN76chMFK7PPNBREREWrH5ICIiIq3YfBAREZFWbD6IiIhIKzYfREREpBVvr+4iS5YsUea9e/eWsokTJxpab8qUKVJ25513Kvdj9CKnMWPGSFmXLl0MbUvey9FXtdSmtvr19/eXMlVN9+nTx+FjIue46667pKxNmzbKdSsqKqSstLRUyn7zm99IWW3ffenp6bcbIgD1FTDXrl2TskOHDim3f+mll6Ts4MGDUlZVVWVoPJ6KZz6IiIhIKzYfREREpBWbDyIiItKKzQcRERFpxQmnGqgmMj300EPKdVUT7GbPni1lV65ckbLMzEwpM5lMyv00b95cyiZMmCBlqklg7777rpSpJqaS5wkODpYy1QS9n376ScdwcPToUWV+8eJFKVP97Hz44YcOHxM5R22TS1VUt0IfN26clHXt2lXKYmNjle+pumW70THdc889UvbII48o11XlmzZtkrINGzZI2TvvvGNoPJ6AZz6IiIhIKzYfREREpBWbDyIiItLK7uZjx44dSE1NRUREBEwmk/R7KSEEsrKyEBERgYCAACQmJuLIkSOOGi9RnbF2yVOxdsnb2D3h9MqVK+jSpQvS09MxfPhw6fX58+dj4cKFyM7ORvv27fHCCy8gKSkJx48fV05mawj+8pe/SFnnzp2V6y5YsEDKrFarlKnu5ldfW7dulTLVXfpUE2g9YcIpa/f2SkpKpEw1OblZs2bK7VV3f6yP0NBQZa6aCK2ahLpt2zaHjsdVvK12VXdJHjlypOHtVXVmNHOGmJgYKavtO/6ZZ56RsoEDBxrKEhISpOypp55S7qe8vFyZuwu7m4+UlBSkpKQoXxNCYNGiRZg5cyaGDRsGAHjvvfcQHh6OVatWKWcjE+nC2iVPxdolb+PQOR8FBQUoKipCcnKyLTObzejXrx/y8/OV25SVlaG4uLjGQqRbXWoXYP2S67F2yRM5tPkoKioCAISHh9fIw8PDba/dbN68eQgNDbUt9lzrTeQodaldgPVLrsfaJU/klKtdbr6xlRCi1ptdzZgxA1ar1bYUFhY6Y0hEhthTuwDrl9wHa5c8iUPvcGqxWAD83Im3atXKlp8/f17qyquZzWaYzebbvnfbtm2l7OTJk3UapzOpjlM1weibb75Rbn+r/6k4m5G/B29Vl9oFjNevJ/vxxx8NZQAQEhIiZb/73e+krPrzvtG3334rZZMnT1buR/WP6saNG6WsIVzx4Ym1q/p7rW0Ss4qqVlzpxIkThjIA2Llzp5T17NlTypYtWyZlv/3tb6Xs+PHjyv28+uqrytxdOPTMR3R0NCwWC3JycmxZeXk58vLy0Lt3b0fuisihWLvkqVi75InsPvPx008/1eg6CwoKcPDgQTRr1gyRkZHIyMjA3LlzERsbi9jYWMydOxeBgYEYNWqUQwdOZC/WLnkq1i55G7ubj3379qF///62P0+bNg0AkJaWhuzsbEyfPh2lpaWYMGECLl26hJ49e2LLli1uea05NSysXfJUrF3yNnY3H4mJicqnXFYzmUzIyspCVlZWfcZF5HCsXfJUrF3yNny2CxEREWnl0KtdnMkdr2xReffdd6VswIABUhYZGaljOHZRXZWjUlBQ4OSRkKeaOHGilGVmZtb5/Wq7VPSzzz6TsgkTJtR5P+R6qr/r2q6q+uMf/+js4TiN6jEAeXl5UvbPf/5Tym68mqlabVdOujue+SAiIiKt2HwQERGRVmw+iIiISCs2H0RERKSVx0w4dUeqW0mrJsZWP+b6RhcuXHDGkAyLi4uTstTUVEPbRkdHO3o45CX+8pe/SNnw4cOl7J577qnXfkpLSw1l5J4OHDggZaoJlm+88YZye6vV6vAxudKSJUukrHPnzlL24YcfSplq8jWgflyG6r4vqs/y+vXryvd0JJ75ICIiIq3YfBAREZFWbD6IiIhIKzYfREREpJVJ3OqBAS5QXFyM0NBQVw/DkBkzZkjZ7NmzpaxPnz5Stm/fPqeM6WZdunRR5mvWrJGyDh06SNnXX38tZf/5n/8pZWfPnq3D6JzParUqJwY7iyfVry4BAQFSlpaWJmWvvvqqlKkmzQFARUWFlFU/bO1GixcvNjJEt8TadY527dop85SUFCm7du2alA0aNEjKVHdnteef1o4dO0qZapyq/dQ24bRJkyZS1qNHDynr27evlOXn5yvf0ygjtcszH0RERKQVmw8iIiLSis0HERERacXmg4iIiLTihNN6OH78uJRVVVVJWXx8vI7hKO9aunbtWuW6qrvnqSZX3XfffVJ28OBB+wfnIpy05zlUE/7+9re/KddVfW19++23UnbvvfdKWXFxcR1Gpx9r1zlUd1cFgLvvvrvO71lUVCRljRs3Vq7bsmVLQ++5d+9eKcvIyJCyb775xtD7AUBsbKyU7d+/X8rqe4dTTjglIiIit8Pmg4iIiLRi80FERERasfkgIiIirXxcPQBPoJrICQARERFSNnToUIfvv3nz5lKmupNqenq6lAUFBSnfs7CwUMp++ctfStmXX35pZIhE9fbpp59K2euvv65cd9KkSVIWExMjZaNHjzb8ntQwbN26VZmfP39eyg4fPixl69evl7ITJ05I2fPPP6/czxNPPGFoTBMnTpQy1aRqe/z444/12t6ReOaDiIiItGLzQURERFqx+SAiIiKt2HwQERGRVmw+iIiISCte7eJgiYmJUvbZZ59JWZMmTZTbL1y4UMoGDhwoZXfeeaeUlZWVSdnbb7+t3M/ixYul7MiRI8p1iW6mugILAB5//HEpu+uuu6TsqaeekrKffvpJymq7YkB1tYuKmz09gtzAs88+6/D3VD2G4tFHH1Wue+zYMSmbOXOmlNX3yhZ3xzMfREREpBWbDyIiItKKzQcRERFpxeaDiIiItOKEUwNUE4QA4OzZs1KmmszUrVs3Kbv77ruV76m6ZbvK8ePHpWzatGlStmnTJkPvRwQAwcHBUqaa3Dl16lTl9v7+/lLWsWNHKVNNLnUGXfuhhkNV4xs3bpQyHx/1P6+qiahHjx6t/8A8DM98EBERkVZsPoiIiEgrNh9ERESkFZsPIiIi0ooTTuth//79UhYbGytlKSkpUmYymZTvqboj4/r166Vs/PjxUnbhwgXlexKptG/fXsreffddKevTp4+UlZeXK9+zV69eUnbmzBkpu+OOO6QsISFByubPn6/cj+rn59y5c1K2c+dO5fZERqgmYH/wwQdSFhoaKmUvvfSS8j0b4uRSFZ75ICIiIq3YfBAREZFWbD6IiIhIK7uaj3nz5qF79+4IDg5GWFgYhg4dKt3sSgiBrKwsREREICAgAImJiXxaKrkca5c8FWuXvJFJ2PHM6YEDB2LkyJHo3r07KioqMHPmTBw+fBhHjx5FUFAQgJ8n2fzhD39AdnY22rdvjxdeeAE7duzA8ePHlZN3blZcXKycvOOOGjduLGUjRoyQMtXjx2ubcLpu3Tops1qtUlZaWmpkiA2e1WpFSEiIltoF3LN+27Vrp8yXL18uZapHg6tcvHhRmdd2N+Cbde3aVcoCAwOlrLafk7KyMin77W9/K2V/+tOfDI3HHbF2XS8uLk7KVE3dqVOnpOzee+9VvmdtPzvepLp2b8Wuq11uvlX3ihUrEBYWhv379+P++++HEAKLFi3CzJkzMWzYMADAe++9h/DwcKxatQrjxo2z8xCIHIO1S56KtUveqF5zPqr/R96sWTMAQEFBAYqKipCcnGxbx2w2o1+/fsjPz1e+R1lZGYqLi2ssRM7miNoFWL+kH2uXvEGdmw8hBKZNm4Y+ffqgc+fOAICioiIAQHh4eI11w8PDba/dbN68eQgNDbUtbdq0qeuQiAxxVO0CrF/Si7VL3qLOzcekSZNw6NAhrF69Wnrt5t/TCiFq/d3tjBkzYLVabUthYWFdh0RkiKNqF2D9kl6sXfIWdbrD6eTJk/HJJ59gx44daN26tS23WCwAfu7EW7VqZcvPnz8vdeXVzGYzzGZzXYbhcpWVlVKm+lIg9+HI2gU8o347deqkzFV3LjU6/7z6lP/NVBNW7ZjTLvnHP/6hzGfNmiVlf/3rX+u8H0/QEGvX1TIyMgyt9+yzz0pZQ5hYWh92nfkQQmDSpElYv349tm3bhujo6BqvR0dHw2KxICcnx5aVl5cjLy8PvXv3dsyIieqAtUueirVL3siuMx8TJ07EqlWr8PHHHyM4ONj2+8TQ0FAEBATAZDIhIyMDc+fORWxsLGJjYzF37lwEBgZi1KhRTjkAIiNYu+SpWLvkjexqPt58800AQGJiYo18xYoVGD16NABg+vTpKC0txYQJE3Dp0iX07NkTW7ZsMXytOZEzsHbJU7F2yRvZ1XwY+d2tyWRCVlYWsrKy6jomIodj7ZKnYu2SN+KzXYiIiEirOl3tQkSe49NPP1Xmzz33nJQNHz5cyjp27Gh4X6dPn5ayAwcOSJnqSoDPP/9cylauXKncT3l5ueExERkxZMgQKVPdsv/cuXNS9tFHHzllTN6MZz6IiIhIKzYfREREpBWbDyIiItKKzQcRERFpxQmnRF6utsmZqssyeakmebtGjdT/5x45cqSUqS5zfvHFFx0+poaIZz6IiIhIKzYfREREpBWbDyIiItKKzQcRERFpxQmnRETUYIwYMcJwXlJSImWbN292+JgaIp75ICIiIq3YfBAREZFWbD6IiIhIKzYfREREpBUnnBIRUYMRGRlpeN3vv/9eyo4dO+bI4TRYPPNBREREWrH5ICIiIq3YfBAREZFWbD6IiIhIKzYfREREpBWvdiEiogbj0KFDynzr1q1S9uGHHzp7OA0Wz3wQERGRVmw+iIiISCs2H0RERKQVmw8iIiLSihNOiYiowdi0aZNdOTkHz3wQERGRVmw+iIiISCs2H0RERKSV2zUfQghXD4G8iO56Yv2So7B2yVMZqSW3az5KSkpcPQTyIrrrifVLjsLaJU9lpJZMws3a3aqqKpw9exbBwcEoKSlBmzZtUFhYiJCQEFcPrd6Ki4t5PJoIIVBSUoKIiAg0aqSvx66uXyEEIiMj3fKzqQt3/ruuC3c+HtauY7nz33VduPPx2FO7bnepbaNGjdC6dWsAgMlkAgCEhIS43YdcHzwePUJDQ7Xvs7p+i4uLAbjvZ1NXPB49WLuOx+PRw2jtut2vXYiIiMi7sfkgIiIirdy6+TCbzZg9ezbMZrOrh+IQPJ6Gw9s+Gx5Pw+Ftnw2Pxz253YRTIiIi8m5ufeaDiIiIvA+bDyIiItKKzQcRERFpxeaDiIiItGLzQURERFq5dfOxdOlSREdHw9/fHwkJCdi5c6erh2TIjh07kJqaioiICJhMJmzYsKHG60IIZGVlISIiAgEBAUhMTMSRI0dcM9jbmDdvHrp3747g4GCEhYVh6NChOH78eI11POl4dGHtuh5rt25Yu+7B2+vXbZuPtWvXIiMjAzNnzsSBAwfQt29fpKSk4PTp064e2m1duXIFXbp0weLFi5Wvz58/HwsXLsTixYuxd+9eWCwWJCUlueWDnfLy8jBx4kTs3r0bOTk5qKioQHJyMq5cuWJbx5OORwfWrntg7dqPtes+vL5+hZvq0aOHGD9+fI0sLi5OZGZmumhEdQNA/PnPf7b9uaqqSlgsFvHiiy/asmvXronQ0FDx1ltvuWCE9jl//rwAIPLy8oQQnn88zsDadU+s3dtj7bovb6tftzzzUV5ejv379yM5OblGnpycjPz8fBeNyjEKCgpQVFRU49jMZjP69evnEcdmtVoBAM2aNQPg+cfjaKxd98XavTXWrnvztvp1y+bjwoULqKysRHh4eI08PDwcRUVFLhqVY1SP3xOPTQiBadOmoU+fPujcuTMAzz4eZ2DtuifW7u2xdt2XN9avj6sHcCsmk6nGn4UQUuapPPHYJk2ahEOHDuHzzz+XXvPE43Emb/48PPHYWLvGefPn4anH5o3165ZnPlq0aIHGjRtL3dv58+elLs/TWCwWAPC4Y5s8eTI++eQT5ObmonXr1rbcU4/HWVi77oe1awxr1z15a/26ZfPh5+eHhIQE5OTk1MhzcnLQu3dvF43KMaKjo2GxWGocW3l5OfLy8tzy2IQQmDRpEtavX49t27YhOjq6xuuedjzOxtp1H6xd+7B23YvX168LJrkasmbNGuHr6yuWLVsmjh49KjIyMkRQUJA4efKkq4d2WyUlJeLAgQPiwIEDAoBYuHChOHDggDh16pQQQogXX3xRhIaGivXr14vDhw+LX/3qV6JVq1aiuLjYxSOXPfnkkyI0NFRs375d/PDDD7bl6tWrtnU86Xh0YO26B9au/Vi77sPb69dtmw8hhFiyZImIiooSfn5+olu3brZLjNxdbm6uACAtaWlpQoifL5GaPXu2sFgswmw2i/vvv18cPnzYtYOuheo4AIgVK1bY1vGk49GFtet6rN26Ye26B2+vX5MQQjj33AoRERHRv7nlnA8iIiLyXmw+iIiISCs2H0RERKQVmw8iIiLSis0HERERacXmg4iIiLRi80FERERasfkgIiIirdh8EBERkVZsPoiIiEgrNh9ERESk1f8H9psKah1+0hEAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 640x480 with 6 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure()\n",
    "f, axarr = plt.subplots(2,3)\n",
    "counter = 0\n",
    "for i in range(2):\n",
    "    for j in range(3):\n",
    "        axarr[i][j].imshow(imgs[counter].squeeze(), cmap=\"gray\")\n",
    "        axarr[i][j].set_title(f\"Predicted {labels[counter]}\")\n",
    "        counter += 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "DL-CV",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
